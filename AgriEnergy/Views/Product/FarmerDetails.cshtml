@model AgriEnergy.Models.User

@{
    ViewData["Title"] = "Farmer Details";
}

<div class="container my-5" data-aos="fade-down">
    <h1 class="display-4 fw-bold text-success text-center">@Model.Name's Details</h1>

    <!-- Filter Form -->
    <div class="mt-4 mb-3" data-aos="fade-right">
        <form asp-controller="Product" asp-action="FarmerDetails" method="get" id="filterForm">
            <input type="hidden" name="id" value="@Model.UserId" />
            <div class="search-container">
                <input class="input" type="text" name="searchString" placeholder="Search..."
                    value="@ViewData["CurrentFilter"]" />
                <input type="date" id="startDate" name="startDate" value="@ViewData["CurrentStartDate"]" />
                <input type="date" id="endDate" name="endDate" value="@ViewData["CurrentEndDate"]" />
                <!-- Category Dropdown -->
                <select name="categoryName" id="categoryName" class="form-select"
                    style="width: 200px; height: 40px; border-radius: 10px; border: 2px solid forestgreen;">
                    <option value="">All Categories</option>
                    @foreach (var category in ViewData["Categories"] as List<AgriEnergy.Models.Category> ?? new
                                        List<AgriEnergy.Models.Category>())
                    {
                        <option value="@category.CategoryName"
                            selected="@(category.CategoryName == ViewData["CurrentCategory"]?.ToString() ? "selected" : null)">
                            @category.CategoryName
                        </option>
                    }
                </select>
                <button class="btnsearch" type="submit">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </div>
        </form>
    </div>
</div>

<div class="container mt-4">
    <div class="row" data-aos="fade-up">
        <div class="col-md-6">
            <div class="p-4 shadow-sm rounded bg-light">
                <h4 class="text-warning fw-bold mb-3">Farmer Information</h4>
                <hr />
                <dl class="row">
                    <dt class="col-sm-3">Name:</dt>
                    <dd class="col-sm-9">@Model.Name</dd>

                    <dt class="col-sm-3">Born:</dt>
                    <dd class="col-sm-9">@Model.Dob</dd>

                    <dt class="col-sm-3">Bio:</dt>
                    <dd class="col-sm-9">@Model.Bio</dd>
                </dl>
            </div>
        </div>
    </div>

    <div class="row mt-5" data-aos="fade-up">
        <h4 class="text-primary fw-bold mb-3">Products Sold</h4>
        <hr />
        <div class="d-flex flex-wrap gap-4 justify-content-start card-container">
            @foreach (var item in Model.Products)
            {
                <div class="card shadow-sm border-0" style="width: 18rem;" data-aos="zoom-in" data-aos-delay="100">
                    <h5 class="card-header bg-success text-white">R @Html.DisplayFor(modelItem => item.Price)</h5>
                    <img src="@item.ImageUrl" class="card-img-top" alt="Product Image">
                    <div class="card-body">
                        <h5 class="card-title">@Html.DisplayFor(modelItem => item.ProductName)</h5>
                        <h6 class="card-subtitle mb-2 text-muted">
                            Quantity: @Html.DisplayFor(modelItem => item.Quantity)
                        </h6>
                        <p class="card-text">
                            Availability:
                            <span class="badge @(item.Availability == "YES" ? "bg-success" : "bg-danger")">
                                @Html.DisplayFor(modelItem => item.Availability)
                            </span>
                        </p>
                        <p class="card-text">Production Date: @Html.DisplayFor(modelItem => item.ProductionDate)</p>
                        <p class="card-text">Category: @(item.Category?.CategoryName ?? "No Category")</p>
                    </div>
                    <div class="card-footer bg-light text-muted">
                        Farmer: @(item.Farmer != null
                                            ? Html.ActionLink(item.Farmer.Name, "FarmerDetails", new { id = item.FarmerId })
                                            : "No Farmer")
                </div>
            </div>
                        }
        </div>
    </div>
</div>

<!-- Scoped Styles -->
<style>
    body {
        background-image: url('https://images.rawpixel.com/image_1300/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIyLTA2L3YxMTYtYWdyaWN1bHR1cmUtMDJlXzEuanBn.jpg');
        background-position: center top;
        background-repeat: no-repeat;
        background-size: cover;
        background-attachment: fixed;
        margin: 0;
    }

    .search-container {
        display: flex;
        align-items: center;
        gap: 10px;
        flex-wrap: wrap;
        position: relative;
        padding: 10px 0;
    }

    .input {
        outline: none;
        border: none;
        border-radius: 100px;
        padding: 10px 20px;
        font-size: 18px;
        width: 250px;
        background-color: yellowgreen;
        color: white;
        transition: width 0.3s ease;
    }

    .input::placeholder {
        color: white;
    }

    .btnsearch {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        border: none;
        background-color: green;
        color: white;
        font-size: 18px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);
        transition: transform 0.3s ease;
    }

    #startDate,
    #endDate {
        border-radius: 10px;
        height: 40px;
        font-size: 16px;
        border: 2px solid forestgreen;
        padding: 0 10px;
        width: 150px;
    }

    .card-img-top {
        max-height: 200px;
        object-fit: cover;
    }

    .card-body {
        font-size: 0.95rem;
    }

    .card-container {
        margin-top: 20px;
    }

    h1 {
        font-size: 48px;
    }

    h4 {
        font-size: 28px;
    }

    .badge {
        font-size: 0.85rem;
        padding: 0.4em 0.6em;
    }
</style>

<!-- Bootstrap 5 -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- AOS Animation Library -->
<link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
<script>
    AOS.init({
        duration: 800,
        once: true
    });
</script>
